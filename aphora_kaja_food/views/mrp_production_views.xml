<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="aphora_mrp_production_tree_view" model="ir.ui.view">
        <field name="name">aphora.mrp.production.tree</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="field[@name='date_start']" position="attributes">
                <attribute name="widget" remove="remaining_days" separator=" "/>
            </xpath>
            <xpath expr="field[@name='date_finished']" position="attributes">
                <attribute name="widget" remove="remaining_days" separator=" "/>
            </xpath>
            <xpath expr="field[@name='date_deadline']" position="attributes">
                <attribute name="widget" remove="remaining_days" separator=" "/>
            </xpath>
            <xpath expr="field[@name='product_id']" position="before">
                <field name="aphora_partner_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <record id="aphora_mrp_production_form_view" model="ir.ui.view">
        <field name="name">aphora.mrp.production.form</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='group_extra_info']//field[@name='date_finished']" position="after">
                <label for="aphora_date_finished_confirmed" class="d-none"/>
                <div name="confirm" class="o_row">
                    <field name="aphora_date_finished_confirmed"/>
                    <span>Confirmed</span>
                </div>
            </xpath>
            <xpath expr="//group[@name='group_extra_info']//field[@name='user_id']" position="after">
                <field name="aphora_partner_id" readonly="state in ['cancel', 'done']"/>
            </xpath>
            <xpath expr="//page[@name='miscellaneous']" position="after">
                <page string="Note" name="aphora_note">
                    <field name="aphora_note" placeholder="Add a note that will be printed on the Production Order"/>
                </page>
                <page string="Legacy" name="aphora_kaja_legacy">
                    <group>
                        <group string="PRODUCTION">
                            <field name="aphora_allergen_ids" widget="many2many_tags"/>
                            <field name="aphora_description_production"/>
                            <field name="aphora_coating_note"/>
                            <field name="aphora_shipping_note"/>
                            <field name="aphora_tray_label"/>
                            <field name="aphora_lot_nomenclature"/>
                        </group>
                        <group string="QUALITY">
                            <field name="aphora_retention_sample"/>
                            <field name="aphora_best_before_date_production"/>
                            <field name="aphora_best_before_date_customer"/>
                            <field name="aphora_best_before_date_sheet"/>
                            <field name="aphora_residual_term_customer"/>
                            <field name="aphora_actitivity_of_water"/>
                            <field name="aphora_description_quality"/>
                            <field name="aphora_weight_check"/>
                        </group>
                    </group>
                    <group>
                        <group string="INVENTORY">
                            <field name="aphora_units_per_tray"/>
                            <field name="aphora_trays_per_layer"/>
                            <field name="aphora_layers_per_pallet"/>
                            <label for="aphora_weight_adjusted"/>
                            <div class="o_row">
                                <field name="aphora_weight_adjusted" class="oe_inline"/>
                                <span class="flex-grow-1">g</span>
                            </div>
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//label[@for='lot_producing_id']" position="before">
                <field name="aphora_batch_size" readonly="state in ['to_close', 'done', 'cancel']"/>
                <field name="aphora_has_kits" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='move_raw_ids']//tree//field[@name='product_type']" position="before">
                <field name="aphora_batch_uom_qty" readonly="1" force_save="1"/>
            </xpath>
            <xpath expr="//field[@name='move_raw_ids']//tree//field[@name='product_id']" position="after">
                <field name="description_bom_line" column_invisible="not parent.aphora_has_kits" optional="show"/>
            </xpath>
        </field>
    </record>
</odoo>
